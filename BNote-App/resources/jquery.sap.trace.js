/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2016 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['jquery.sap.global','sap/ui/thirdparty/URI','sap/ui/Global'],function(q,U){"use strict";(function(){var f=/sap-ui-xx-fesr=(true|x|X)/.test(location.search),t,I,m,R=z(),C=z().substr(-8,8)+R,H=new U(window.location).host(),a=sap.ui.Device.os.name+"_"+sap.ui.Device.os.version,b=sap.ui.Device.browser.name+"_"+sap.ui.Device.browser.version,c="",E,T,F,p={},S=0,d,o,g,h,j=0;function k(){if(!m){m=true;if(!(window.performance&&window.performance.getEntries)){q.sap.log.warning("Interaction tracking is not supported on browsers with insufficient performance API");}var X=window.XMLHttpRequest.prototype.open,e=window.XMLHttpRequest.prototype.send,i=window.XMLHttpRequest.prototype.setRequestHeader;window.XMLHttpRequest.prototype.open=function(){X.apply(this,arguments);if(I||f||t){var s=new U(arguments[1]).host();if(!s||s===H){T=z();if(I||f){this.addEventListener("readystatechange",l);this.pendingInteraction=p;if(f){if(g){this.setRequestHeader("SAP-Perf-FESRec",g);this.setRequestHeader("SAP-Perf-FESRec-opt",h);g=null;h=null;F=T;S++;}else if(!F){F=T;}this.setRequestHeader("SAP-PASSPORT",y(E,R,T,p.component+(p.appVersion?"@"+p.appVersion:"")+(c?"@"+c:""),p.trigger+"_"+p.event+"_"+S));}}if(!f&&t){this.setRequestHeader("SAP-PASSPORT",y(E,R,T));}}}};window.XMLHttpRequest.prototype.send=function(){e.apply(this,arguments);if((I||f)&&this.pendingInteraction){this.pendingInteraction.bytesSent+=arguments[0]?arguments[0].length*2:0;}};window.XMLHttpRequest.prototype.setRequestHeader=function(s,V){i.apply(this,arguments);if(I||f){if(!this.requestHeaderLength){this.requestHeaderLength=0;}this.requestHeaderLength+=(s.length+V.length+3)*2;}};window.addEventListener("scroll",q.sap.interaction.notifyScrollEvent);window.addEventListener("mousewheel",q.sap.interaction.notifyScrollEvent);}}function l(){if(this.readyState===4&&this.pendingInteraction){var s=this.getResponseHeader("content-length"),e=this.getResponseHeader("content-encoding")==="gzip",i=this.getResponseHeader("sap-perf-fesrec");this.pendingInteraction.bytesReceived+=s?parseInt(s,10):0;this.pendingInteraction.bytesReceived+=this.getAllResponseHeaders().length*2;this.pendingInteraction.bytesSent+=this.requestHeaderLength||0;this.pendingInteraction.requestCompression=e&&(this.pendingInteraction.requestCompression!==false);this.pendingInteraction.networkTime+=i?Math.round(parseFloat(i,10)/1000):0;var A=this.getResponseHeader("sap-statistics");if(A){this.pendingInteraction.sapStatistics.push({url:this.responseURL,statistics:A,timing:q.sap.measure.getRequestTimings().pop()});}delete this.requestHeaderLength;delete this.pendingInteraction;}}function n(i){return[u(R,32),u(F,32),u(i.navigation,16),u(i.roundtrip,16),u(i.duration,16),u(i.requests.length,8),u(C,40),u(i.networkTime,16),u(i.requestTime,16),u(a,20),"SAP_UI5"].join(",");}function r(i){return[u(i.component,20,true),u(i.trigger+"_"+p.event,20,true),"",u(b,20),u(i.bytesSent,16),u(i.bytesReceived,16),"","",u(i.processing,16),i.requestCompression?"X":"","","","","",u(i.busyDuration,16),"","","",""].join(",");}function u(e,L,i){if(!e){e=e===0?"0":"";}else if(typeof e==="number"){e=Math.round(e).toString();if(e.length>L){e="-1";}}else{e=i?e.substr(-L,L):e.substr(0,L);}return e;}q.sap.interaction={};q.sap.interaction.setActive=function(A){if(A&&!I){k();}I=A;};q.sap.interaction.getActive=function(){return I||f;};q.sap.interaction.notifyStepStart=function(e,i){if(I||f){if(o||i){var s;if(i){s="startup";}else if(o.originalEvent){s=o.originalEvent.type;}else{s=o.type;}q.sap.measure.startInteraction(s,e);var A=q.sap.measure.getAllInteractionMeasurements();var B=A[A.length-1];var P=q.sap.measure.getPendingInteractionMeasurement();p=P?P:p;if(f&&B&&B.requests.length>0){g=n(B);h=r(B);}o=null;}}};q.sap.interaction.notifyStepEnd=function(){if(I||f){if(d){q.sap.clearDelayedCall(d);}d=q.sap.delayedCall(1,q.sap.measure,"endInteraction");}};q.sap.interaction.notifyEventStart=function(e){o=(I||f)?e:null;};function v(){q.sap.interaction.notifyStepStart();j=0;}q.sap.interaction.notifyScrollEvent=function(e){if(I||f){if(!j){q.sap.interaction.notifyEventStart(e);}else{q.sap.clearDelayedCall(j);}j=q.sap.delayedCall(250,undefined,v);}};q.sap.interaction.notifyEventEnd=function(){if(o){if(o.type.match(/^(mousedown|touchstart|keydown)$/)){q.sap.measure.endInteraction(true);}}};q.sap.fesr={};q.sap.fesr.setActive=function(A){if(A&&!f){f=true;if(!I){k();}}else if(!A){f=false;}};q.sap.fesr.getActive=function(){return f;};q.sap.fesr.getCurrentTransactionId=function(){return T;};q.sap.fesr.getRootId=function(){return R;};q.sap.fesr.addBusyDuration=function(D){if(!p.busyDuration){p.busyDuration=0;}p.busyDuration+=D;};q.sap.passport={};q.sap.passport.setActive=function(A){if(A&&!t){t=true;k();}else if(!A){t=false;}};function w(s){var e=[];for(var i=0;i<s.length;++i){e.push(s.charCodeAt(i));}return e;}function x(e){var s="";for(var i=0;i<e.length;i++){var A=e[i].toString(16);A=Array(2-A.length+1).join("0")+A;s+=A;}return s;}function y(e,i,s,A,B){var D=[0x2A,0x54,0x48,0x2A,0x03,0x01,0x30,0x00,0x00,0x53,0x41,0x50,0x5F,0x45,0x32,0x45,0x5F,0x54,0x41,0x5F,0x50,0x6C,0x75,0x67,0x49,0x6E,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00,0x00,0x53,0x41,0x50,0x5F,0x45,0x32,0x45,0x5F,0x54,0x41,0x5F,0x55,0x73,0x65,0x72,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x53,0x41,0x50,0x5F,0x45,0x32,0x45,0x5F,0x54,0x41,0x5F,0x52,0x65,0x71,0x75,0x65,0x73,0x74,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00,0x05,0x53,0x41,0x50,0x5F,0x45,0x32,0x45,0x5F,0x54,0x41,0x5F,0x50,0x6C,0x75,0x67,0x49,0x6E,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x34,0x36,0x33,0x35,0x30,0x30,0x30,0x30,0x30,0x30,0x33,0x31,0x31,0x45,0x45,0x30,0x41,0x35,0x44,0x32,0x35,0x30,0x39,0x39,0x39,0x43,0x33,0x39,0x32,0x42,0x36,0x38,0x20,0x20,0x20,0x00,0x07,0x46,0x35,0x00,0x00,0x00,0x31,0x1E,0xE0,0xA5,0xD2,0x4E,0xDB,0xB2,0xE4,0x4B,0x68,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x00,0xE2,0x2A,0x54,0x48,0x2A,0x01,0x00,0x27,0x00,0x00,0x02,0x00,0x03,0x00,0x02,0x00,0x01,0x04,0x00,0x08,0x58,0x00,0x02,0x00,0x02,0x04,0x00,0x08,0x30,0x00,0x02,0x00,0x03,0x02,0x00,0x0B,0x00,0x00,0x00,0x00,0x2A,0x54,0x48,0x2A,0x01,0x00,0x23,0x01,0x00,0x01,0x00,0x01,0x00,0x02,0x00,0x01,0x03,0x00,0x17,0x00,0xAB,0xCD,0xEF,0xAB,0xCD,0xEF,0xAB,0xCD,0xEF,0xAB,0xCD,0xEF,0xAB,0xCD,0xEF,0x2A,0x54,0x48,0x2A];var G=[372,32];var J=[149,32];var K=[9,32];var P=[117,32];var L=[75,40];var M=[7,2];var N=w("SAP_E2E_TA_UI5LIB");N=N.concat(w(new Array(32+1-N.length).join(' ')));if(A){A=w(A.substr(-32,32));A=A.concat(w(new Array(32+1-A.length).join(' ')));D.splice.apply(D,K.concat(A));D.splice.apply(D,P.concat(A));}else{D.splice.apply(D,K.concat(N));D.splice.apply(D,P.concat(N));}D.splice.apply(D,J.concat(w(s)));D.splice.apply(D,M.concat(e));if(B){B=w(B.substr(-40,40));B=B.concat(w(new Array(40+1-B.length).join(' ')));D.splice.apply(D,L.concat(B));}var O=x(D).toUpperCase();return O.substring(0,G[0]).concat(i)+O.substring(G[0]+G[1]);}q.sap.passport.traceFlags=function(e){switch(e){case'low':E=[0x00,0x00];break;case'medium':E=[0x89,0x0A];break;case'high':E=[0x9F,0x0D];break;default:E=[];E.push((parseInt(e,16)&0xFF00)/256);E.push((parseInt(e,16)&0xFF));}return E;};function z(){var e=function(){var B=Math.floor(Math.random()*0x10000);return(new Array(4+1-B.toString(16).length)).join('0')+B.toString(16);};var i=function(){var B=(Math.floor(Math.random()*0x10000)&0x0fff)+0x4000;return(new Array(4+1-B.toString(16).length)).join('0')+B.toString(16);};var s=function(){var B=(Math.floor(Math.random()*0x10000)&0x3fff)+0x8000;return(new Array(4+1-B.toString(16).length)).join('0')+B.toString(16);};var A=(e()+e()+e()+i()+s()+e()+e()+e());return A.toUpperCase();}E=q.sap.passport.traceFlags();q.sap.interaction.notifyStepStart(null,true);if(f){sap.ui.getVersionInfo({async:true}).then(function(i){c=i&&i.version?i.version:"";}).catch(function(e){q.sap.log.debug("UI5 version could not be determined",e,"jQuery.sap.fesr");});k();}if(/sap-ui-xx-e2e-trace=(true|x|X)/.test(location.search)){q.sap.require("sap.ui.core.support.trace.E2eTraceLib");}}());return q;});
